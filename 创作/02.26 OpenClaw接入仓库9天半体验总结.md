# OpenClaw 接入仓库 9 天半体验总结

接入 OpenClaw 的 9 天半时间里，观察到一个清晰的现象：当 AI 助手从被动响应转向主动推进时，知识管理和任务执行的效率会出现质的飞跃。

## 数据与观察

### 时间跨度与产出

从 2026-02-16 到 2026-02-26，共 9 天半时间：

- **总 commit 数**：366 个 commit，平均每天约 38.5 个
- **笔记整理次数**：30 次，平均每天约 3.16 次
- **核心功能实现**：5 个核心系统 + 20+ 技能集成
- **技能集成数量**：20+ 个 Skills 集成

Commit 趋势呈现明显的三个阶段：
- **初期（02-16 到 02-18）**：快速适应，commit 数量适中（53、45、5），主要是基础配置和规则建立
- **中期（02-19 到 02-22）**：快速迭代，commit 数量激增（37、42、14、45），主要是功能实现和优化
- **后期（02-23 到 02-26）**：稳定优化，commit 数量趋于稳定（33、39、46、7），主要是 bug 修复和体验优化

### 详细数据统计

| 日期 | Commit 数 | 说明 |
|------|-----------|------|
| 2026-02-16 | 53 | 接入初期，快速适应 |
| 2026-02-17 | 45 | 基础配置和规则建立 |
| 2026-02-18 | 5 | 沉淀和反思 |
| 2026-02-19 | 37 | 功能实现和优化 |
| 2026-02-20 | 42 | 功能实现和优化 |
| 2026-02-21 | 14 | 沉淀和反思 |
| 2026-02-22 | 45 | 功能实现和优化 |
| 2026-02-23 | 33 | 稳定优化 |
| 2026-02-24 | 39 | 稳定优化 |
| 2026-02-25 | 46 | 稳定优化 |
| 2026-02-26 | 7 | 收尾和总结 |

## 核心功能实现

### 1. Todos Web Manager

Todos Web Manager 是整个系统的核心界面，实现了完整的任务管理功能：

- **任务状态管理**：pending、in-progress、completed 三态流转
- **Plan 生成与 Review**：智能任务拆解 + 用户审核机制
- **Git 集成**：commit、push、pull 一键操作
- **Code Diff 展示**：支持两个 commit 之间的 diff 查看
- **执行日志与指标**：可观测闭环，让任务执行过程透明化
- **变更文件列表记录**：支持 todos 完成时记录变更的文件列表
- **Typora 跳转支持**：从 todo web manager 前端直接跳转到对应文件的 Typora 阅读器

这个系统的设计体现了一个重要原则：**单一数据源**。以 JSON 为唯一数据源，避免了数据不一致的问题。

### 2. Task Execution Logger 可观测闭环

可观测性是 AI 助手系统的关键能力。Task Execution Logger 实现了：

- **任务状态机**：planning → executing → completed → failed，完整的生命周期追踪
- **执行日志记录**：支持 info、debug、warning、error 多级日志
- **指标收集**：执行时间、重试次数、成功率等关键指标
- **Web 界面展示**：让用户能够直观地看到任务执行情况

这个系统的价值在于：**让 AI 的工作过程不再是黑盒**。

### 3. Plan Generator + Hybrid Executor

智能任务拆解与执行是提升效率的关键：

- **Plan 生成**：任务分析、步骤拆解、风险评估，基于 LLM 的智能拆解
- **Plan Review 机制**：用户审核，确保计划符合预期
- **混合执行方式**：自动执行 + 人工干预，平衡效率与可控性

Plan 机制的本质化重构是一个重要突破：Plan 不再是独立的状态，而是 Todo 的一个字段（property）。这种设计让数据模型更加简洁。

### 4. Commit Diff 展示功能

完成 todo 时展示两个 commit 之间的 diff，这个功能看似微小，却体现了对用户体验的深刻理解：

- **记录修改前的 HEAD**：在开始修改前保存当前 commit hash
- **记录修改后的 commit hash**：完成修改后保存新的 commit hash
- **前端展示两个 commit 之间的 diff**：让用户能够直观地看到修改内容
- **支持点击查看详细 diff**：提供深入查看的能力
- **变更文件列表记录**：自动获取并记录变更的文件列表
- **Typora 跳转支持**：从变更文件列表直接跳转到 Typora 阅读器

这个功能的核心价值在于：**让任务交付更加透明，让用户能够快速验证变更是否符合预期**。

### 5. 多个 Skills 集成

20+ 个 Skills 的集成，构建了丰富的功能生态：

**文档处理类**：
- pdf-parser：PDF 解析器，支持解析为 Markdown、JSON、提取图片和表格
- markdown-toc：提取 Markdown 文件的目录层级结构

**网页抓取类**：
- playwright-scraper：使用 Playwright 进行网页抓取
- search-web：联网搜索问答
- ask-echo：火山引擎 Ask-Echo 融合信息搜索

**Todo 管理类**：
- todo-adder：Todo 添加器
- todo-updater：Todo 更新器
- priority-task-reader：优先级任务读取器
- smart-task-parser：智能任务解析器

**效率工具类**：
- session-optimizer：Session 优化器
- top-lean-ai-monitor：Top Lean AI 榜单监控器
- image-generate：图片生成器
- video-generate：视频生成器
- openai-whisper：语音转文字

**集成类**：
- mcporter：MCP 服务器管理工具
- common-fetcher：统一采集框架（207+ 采集源）
- trae-agent：Trae Agent 集成
- plan-executor：Plan 执行器
- cs-notes-git-sync：CS-Notes Git 同步
- cs-notes-todo-sync：CS-Notes Todo 同步

## 关键的人类经验

接入 OpenClaw 的过程中，沉淀了 8 个关键的人类经验，这些经验比技术实现本身更有价值。

### 1. 需要磨合

OpenClaw 不是开箱即用的，需要时间来磨合。

**具体表现**：
- 初期需要配置和调整，不能立刻达到理想状态
- 需要积累使用经验，形成适合自己的工作流
- 需要深度定制，才能发挥最大价值

**启示**：
- 需要配置和调整：不要期望开箱即用，要有耐心
- 需要积累使用经验：记录使用过程中的经验和教训
- 磨合后可以形成适合自己的工作流：经过一段时间的磨合，工作流会越来越顺畅
- 可以深度定制：OpenClaw 支持深度定制，可以根据自己的需求进行调整

### 2. 安全意识：敏感内容绝对不允许上传到公开 GitHub 仓库

这是一个血泪教训，必须时刻牢记。

**惨痛教训**：
- 曾经差点把真实的 API key 提交到公开仓库
- 曾经差点把公司项目的内容提交到公开仓库
- 这些错误如果发生，后果不堪设想

**启示**：
- 在写入任何文件到仓库前，必须检查是否有敏感内容
- 在 commit 前，必须检查 git status，看看有没有不该提交的文件
- 在写入任何包含配置的文档时，必须把敏感内容替换成占位符（API key → "YOUR_API_KEY" 等）
- 永远不要把真实的敏感内容写入到任何会被提交到仓库的文件中

**具体措施**：
- **白名单机制**：仅允许 `Notes/`、`.trae/`、`创作/` 三个文件夹
- **黑名单机制**：绝对禁止 `公司项目/` 文件夹
- **.gitignore 配置**：确保 `**/公司项目/**` 在 .gitignore 中
- **检查步骤**：每次 commit 前，先执行 `git status` 检查，或直接运行 `todo-push.sh`

### 3. Git 操作 SOP

Git 操作必须有标准流程，不能直接用 git 命令。

**为什么需要 SOP？**：
- 直接使用 git 命令容易出错
- 容易把不该提交的文件提交到仓库
- 容易忘记 push 或 pull
- 缺乏统一的 commit message 规范

**启示**：
- todo-push.sh 白名单机制：仅允许 `Notes/`、`.trae/`、`创作/` 三个文件夹
- todo-push.sh 黑名单机制：绝对禁止 `公司项目/` 文件夹
- 验证步骤：每次 commit 前，先执行 `git status` 检查，或直接运行 `todo-push.sh`
- .gitignore 配置：确保 `**/公司项目/**` 在 .gitignore 中
- 公司项目/ 目录规则：该目录下的所有内容永远不要 git add 到公开仓库
- Git Push/Pull 工作流程：完成任务 → 运行 todo-push.sh → 生成 commit message → 运行 todo-push-commit.sh
- Commit 链接：每次进行 git commit 并 push 后，必须在回复中包含对应的 GitHub commit 链接
- **完成todo后立刻push**：完成todo后，立即运行 todo-push.sh 进行 commit 和 push
- **将commit链接发送给用户**：每次进行 git commit 并 push 后，必须在回复中包含对应的 GitHub commit 链接
- **不要等待用户问才push**：要主动 push，不要等到用户问才 push

### 4. 笔记整理 SOP

整理笔记时，必须严格遵循规则。

**为什么需要 SOP？**：
- 笔记整理容易放错位置
- 容易丢失信息
- 容易出现幻觉（加入不相关的信息）
- 缺乏引用，难以追溯来源

**启示**：
- 先提取文件目录结构：使用 markdown-toc skill 提取多个潜在目标 Markdown 文件的目录结构
- 先在笔记库中广泛搜索，找到最合适的已有的笔记
- 找到最合适的 section，而不是随便找个地方就放
- 将内容整合到合适的 section 中，而不是创建新文件
- 附上来源链接作为引用，用 markdown 格式标注链接
- 尽量精简语言，精炼整理笔记
- 格式上：减少不必要的加粗、尽量对齐原文件的格式
- 引用原则：所有从外部材料（文章、网页、视频等）整理的内容，必须在相关章节开头或内容旁边附上来源链接作为引用
- 限制：不要删除原笔记中的内容，只允许进行整合，不能丢失信息
- 无幻觉原则：仅保留真实内容，不要加入不相关的信息
- 简洁原则：笔记整理要简洁，不要啰嗦，用 bullet point 列表，简洁明了

### 5. Todo 管理原则

以 `.trae/todos/todos.json` 为单一数据源。

**为什么需要单一数据源？**：
- 避免数据不一致
- 避免重复劳动
- 便于管理和维护
- 便于统计和分析

**启示**：
- Plan 机制本质化重构：Plan 不再是独立的状态，而是 Todo 的一个字段（property）
- 任务归档前的用户确认流程：在将 completed 任务从 todos.json 移动到 archive 之前，必须增加一次由用户进行 check/反馈的流程
- Todos 管理的正确流程：
  1. AI 执行任务，完成编码/实现部分
  2. 到了需要用户验证/确认的阶段时，自动归类到 "User 需要做的任务" section
  3. 明确标注 Assignee: User，并且提醒用户去做
  4. 等待用户完成后，再标记为完成
- Review 流程：
  - 通过: 任务自动归档，记录 Review 历史
  - 不通过: 任务回到 `in-progress`，附带 Review 意见，AI 可以看到并改善

### 6. 用户交互原则

无论 AI 正在执行什么任务，收到用户的新消息时必须立即回复，绝对不能让任务阻塞对话。

**为什么需要这个原则？**：
- 用户体验很重要，不能让用户等待
- AI 应该是助手，而不是主角
- 长时间任务应该后台化，不应该阻塞用户交互

**启示**：
- 长时间任务后台化：对于耗时操作，必须使用后台模式（background: true）运行
- 进度报告要求：主动、定期（每 10 分钟）检查任务进度，向用户报告，包含百分比、预估剩余时间
- Intervention 定义：只要用户和 AI 说话就算一次交互，每次交互后计数清零，在两次交互之间主动推进任务
- 自主推进原则：只有需要用户做选择题的时候才找用户确认，否则尽量自主推进一切事项

### 7. 任务交付原则

不是写了、实现了就算 done，而是要用起来、用好。

**为什么需要这个原则？**：
- 很多任务只是写了代码，但是没有真正用起来
- 很多功能只是玩具代码，没有经过实际验证
- 缺乏端到端验证，容易出现问题

**启示**：
- 落地的定义：成为了本仓库在各种交互方式下的默认 setting，并体验和效果良好，而不仅是有个设计文档和玩具代码即算落地
- 任务交付要更侧重于更 solid 的端到端验证，不仅仅是完成任务，更要进行 thorough 的端到端验证

### 8. 错误反思与改进原则

遇到失败时在技术文档记录跑的命令和错误。

**为什么需要这个原则？**：
- 避免重复犯错
- 便于后续排查问题
- 便于总结经验教训

**启示**：
- 及时沉淀经验：避免重复犯错
- 小步快跑：把大任务拆成多个小阶段，每个阶段都有明确的产出
- 快速迭代：优先实现可用的最小版本，后续再逐步完善

### 9. Review 瓶颈与缓解路径

接入 OpenClaw 的 9 天半时间里，观察到一个清晰的现象：Review AI 的工作成为了明显的瓶颈，但这个瓶颈会伴随 agent 个性化能力提升、能力提升而得以缓解。

**项目真实数据**：
- **总任务数**：69 个
- **已完成任务数**：23 个
- **有 Review 的任务数**：13 个
- **总 Review 次数**：14 次
- **Review 不通过次数**：14 次
- **Review 通过率趋势**：初期需要多轮 Review，但随着 AI 能力和个性化提升，Review 需求会逐渐减少

这些数据清晰地表明：在当前阶段，Review 确实成为了瓶颈。很多任务都需要经过多轮 Review 才能最终完成。

**为什么会出现这种情况？**：
- **初期磨合阶段**：AI 刚接入，还在学习和适应用户的工作方式和偏好
- **能力匹配度**：AI 的能力和用户的期望之间还存在一定的差距
- **个性化不足**：AI 还没有充分理解用户的工作风格、偏好和价值观

**缓解路径**：
- **伴随 agent 个性化能力提升**：随着 AI 越来越了解用户的工作方式和偏好，Review 的次数会逐渐减少
- **能力提升**：随着 AI 能力的不断提升，任务完成质量会越来越好，需要 Review 的次数会越来越少
- **从需要多轮 Review 到逐渐减少**：这是一个从需要频繁 Review 到逐渐减少 Review 的过程，需要时间和耐心

**启示**：
- Review 瓶颈是暂时的：随着 AI 的个性化和能力提升，这个瓶颈会逐渐缓解
- 需要持续迭代：通过不断的反馈和调整，AI 会越来越贴合用户的需求
- 长远来看，效率会显著提升：一旦度过了初期的磨合阶段，AI 助手的效率会显著提升

这 9 天半的经历，是一个从被动响应到主动推进、从需要频繁 Review 到逐渐减少 Review 的转变过程。这个过程中，数据会说话：Review 次数会逐渐减少，任务完成质量会逐渐提升。

## 架构设计与技术选型

### 整体架构

```
┌─────────────────────────────────────────────────────────────┐
│                         用户界面层                          │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │  Web Manager │  │    IM Bot    │  │  CLI Tools   │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                       业务逻辑层                            │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │ Todo Manager │  │ Plan Manager │  │  Git Manager │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │ Skill System │  │ Memory System│  │ Log System   │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                        数据存储层                            │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │  todos.json  │  │  plans/      │  │  logs/       │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │  MEMORY.md   │  │  memory/     │  │  Notes/       │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

### 技术选型

| 层级 | 技术选型 | 选型理由 |
|------|----------|----------|
| 前端 | Vanilla JavaScript + HTML5 + CSS3 | 简单、轻量、无需构建 |
| 后端 | Python Flask | 成熟、稳定、生态丰富 |
| 数据存储 | JSON 文件 | 简单、易读、易调试 |
| 日志格式 | JSON Lines (JSONL) | 结构化、易解析、易扩展 |
| 可视化 | Chart.js | 简单、易用、功能丰富 |
| 网页抓取 | Playwright | 功能强大、支持多种浏览器 |
| 语音转文字 | OpenAI Whisper | 准确率高、支持多种语言 |

### 设计原则

1. **单一数据源原则**：以 JSON 为单一数据源，避免数据不一致
2. **可观测性优先原则**：所有任务执行必须记录日志和指标
3. **安全第一原则**：敏感内容绝对不允许上传到公开 GitHub 仓库
4. **用户体验优先原则**：无论 AI 正在执行什么任务，收到用户的新消息时必须立即回复
5. **小步快跑原则**：把大任务拆成多个小阶段，每个阶段都有明确的产出
6. **快速迭代原则**：优先实现可用的最小版本，后续再逐步完善
7. **完成todo后立刻push原则**：完成todo后，立即运行 todo-push.sh 进行 commit 和 push，且将commit链接发送给用户
8. **创作文风参考原则**：当进行创作（修改创作和公司项目文件夹中的文件时），请参考创作文件夹中的文章的整体文风

## 总结与思考

接入 OpenClaw 的 9 天半时间里，取得了显著的进展，但更重要的是沉淀了 8 个关键的人类经验。这些经验比技术实现本身更有价值，因为它们代表了人与 AI 协作的最佳实践。

### 关键成功因素

1. **快速适应**：快速适应 OpenClaw 的工作方式
2. **持续迭代**：小步快跑，快速迭代
3. **经验沉淀**：及时沉淀经验教训
4. **用户体验优先**：始终把用户体验放在第一位
5. **安全第一**：始终把安全放在第一位

### 不足与改进

1. **初期磨合不够**：初期需要更多时间来磨合
2. **功能还不够完善**：还有很多功能可以优化和扩展
3. **能力复用性还不够**：还需要提高能力的复用性
4. **可观测性还可以更好**：还可以进一步提高可观测性

### 未来展望

1. **继续磨合**：继续使用 OpenClaw，积累更多使用心得
2. **能力复用性**：思考如何提高能力的复用性
3. **观察 Agent 领域发展**：持续观察 Agent 领域的发展
4. **功能优化**：优化 Todos Web Manager 的用户体验，优化 Task Execution Logger 的性能，优化 Plan Generator 的任务拆解能力

接入 OpenClaw 的 9 天半，是一个从被动响应到主动推进的转变过程。这个过程中，技术实现固然重要，但更重要的是沉淀了人与 AI 协作的最佳实践。这些经验将为未来的工作奠定坚实的基础。

---

*最后更新：2026-02-26*
