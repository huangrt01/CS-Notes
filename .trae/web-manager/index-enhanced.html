<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS-Notes Todos Web Manager - å¢å¼ºç‰ˆï¼ˆå¼€å‘éªŒè¯ï¼‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 24px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 14px;
        }
        
        .dev-badge {
            display: inline-block;
            background: #ff6b6b;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-top: 8px;
        }
        
        .tabs {
            display: flex;
            background: #f7f7f7;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .tab {
            flex: 1;
            padding: 16px;
            text-align: center;
            cursor: pointer;
            font-weight: 500;
            color: #666;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        
        .tab:hover {
            background: #f0f0f0;
            color: #667eea;
        }
        
        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: white;
        }
        
        .content {
            padding: 24px;
        }
        
        /* å¼€å‘éªŒè¯é¢æ¿ */
        .dev-panel {
            background: #1a1a2e;
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
        }
        
        .dev-panel h3 {
            color: #667eea;
            margin-bottom: 16px;
        }
        
        .dev-row {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-bottom: 12px;
        }
        
        .dev-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .dev-btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }
        
        .dev-btn-secondary {
            background: #4a5568;
        }
        
        .dev-btn-success {
            background: #38a169;
        }
        
        .dev-btn-danger {
            background: #e53e3e;
        }
        
        .dev-status {
            background: #2d3748;
            padding: 16px;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .dev-status-line {
            margin-bottom: 4px;
            padding: 4px 0;
        }
        
        .dev-status-line.success {
            color: #68d391;
        }
        
        .dev-status-line.error {
            color: #fc8181;
        }
        
        .dev-status-line.info {
            color: #63b3ed;
        }
        
        /* ç­›é€‰å’Œæœç´¢åŒºåŸŸ */
        .filters {
            background: #f7f7f7;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
        }
        
        .filters h3 {
            margin-bottom: 16px;
            color: #333;
        }
        
        .filters-row {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }
        
        .filter-group {
            flex: 1;
            min-width: 200px;
        }
        
        .filter-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        .filter-group select,
        .filter-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .add-task {
            background: #f7f7f7;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
        }
        
        .add-task h3 {
            margin-bottom: 16px;
            color: #333;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        
        .task-list {
            list-style: none;
        }
        
        .task-item {
            background: #fafafa;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.3s;
        }
        
        .task-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }
        
        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .task-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            flex: 1;
        }
        
        .task-priority {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 12px;
        }
        
        .priority-high {
            background: #fee2e2;
            color: #dc2626;
        }
        
        .priority-medium {
            background: #fef3c7;
            color: #d97706;
        }
        
        .priority-low {
            background: #dcfce7;
            color: #16a34a;
        }
        
        .task-description {
            color: #666;
            margin-bottom: 12px;
            line-height: 1.6;
        }
        
        .task-meta {
            display: flex;
            gap: 16px;
            font-size: 13px;
            color: #888;
        }
        
        .task-actions {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #e0e0e0;
        }
        
        .btn-secondary {
            background: #f0f0f0;
            color: #333;
            padding: 8px 16px;
            font-size: 14px;
        }
        
        .btn-secondary:hover {
            background: #e0e0e0;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #888;
        }
        
        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 16px;
        }
        
        @media (max-width: 600px) {
            .header h1 {
                font-size: 22px;
            }
            
            .content {
                padding: 16px;
            }
            
            .task-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .task-priority {
                margin-left: 0;
            }
            
            .filters-row {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“ CS-Notes Todos</h1>
            <p>ä»»åŠ¡ç®¡ç†ç³»ç»Ÿ - å¢å¼ºç‰ˆï¼ˆå¼€å‘éªŒè¯ä¸“ç”¨ï¼‰</p>
            <div class="dev-badge">ğŸ”§ å¼€å‘éªŒè¯æ¨¡å¼</div>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="all">ğŸ“‹ å…¨éƒ¨</div>
            <div class="tab" data-tab="pending">â¸ï¸ å¾…å¤„ç†</div>
            <div class="tab" data-tab="in-progress">ğŸš€ è¿›è¡Œä¸­</div>
            <div class="tab" data-tab="completed">âœ… å·²å®Œæˆ</div>
            <div class="tab" data-tab="dev">ğŸ”§ å¼€å‘éªŒè¯</div>
        </div>
        
        <div class="content">
            <!-- å¼€å‘éªŒè¯é¢æ¿ -->
            <div class="dev-panel" id="devPanel">
                <h3>ğŸ”§ å¼€å‘éªŒè¯å·¥å…·</h3>
                <div class="dev-row">
                    <button class="dev-btn" onclick="loadSampleTasks()">ğŸ“¥ åŠ è½½ç¤ºä¾‹ä»»åŠ¡</button>
                    <button class="dev-btn dev-btn-success" onclick="document.getElementById('jsonFileInput').click()">ğŸ“‚ åŠ è½½ JSON æ–‡ä»¶</button>
                    <input type="file" id="jsonFileInput" accept=".json" style="display: none;" onchange="loadJSONFile(event)">
                    <button class="dev-btn dev-btn-secondary" onclick="parseMarkdownTest()">ğŸ“ æµ‹è¯• Markdown è§£æ</button>
                    <button class="dev-btn dev-btn-danger" onclick="clearDevStatus()">ğŸ—‘ï¸ æ¸…ç©ºæ—¥å¿—</button>
                </div>
                <div class="dev-row">
                    <button class="dev-btn" onclick="testGitIntegration()">ğŸ”— æµ‹è¯• Git é›†æˆ</button>
                    <button class="dev-btn dev-btn-secondary" onclick="exportTasksJSON()">ğŸ“¤ å¯¼å‡ºä»»åŠ¡ JSON</button>
                    <button class="dev-btn dev-btn-success" onclick="validateTasks()">âœ… éªŒè¯ä»»åŠ¡æ•°æ®</button>
                </div>
                <div class="dev-status" id="devStatus">
                    <div class="dev-status-line info">ğŸ‘‰ å¼€å‘éªŒè¯å·¥å…·å·²å°±ç»ªï¼Œç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•</div>
                </div>
            </div>
            
            <!-- ç­›é€‰å’Œæœç´¢åŒºåŸŸ -->
            <div class="filters">
                <h3>ğŸ” ç­›é€‰å’Œæœç´¢</h3>
                <div class="filters-row">
                    <div class="filter-group">
                        <label>æŒ‰ä¼˜å…ˆçº§ç­›é€‰</label>
                        <select id="filterPriority" onchange="applyFilters()">
                            <option value="all">å…¨éƒ¨ä¼˜å…ˆçº§</option>
                            <option value="high">ğŸ”´ é«˜ä¼˜å…ˆçº§</option>
                            <option value="medium">ğŸŸ¡ ä¸­ä¼˜å…ˆçº§</option>
                            <option value="low">ğŸŸ¢ ä½ä¼˜å…ˆçº§</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>æŒ‰ Assignee ç­›é€‰</label>
                        <select id="filterAssignee" onchange="applyFilters()">
                            <option value="all">å…¨éƒ¨ Assignee</option>
                            <option value="AI">ğŸ‘¤ AI</option>
                            <option value="User">ğŸ‘¤ User</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>æœç´¢ä»»åŠ¡</label>
                        <input type="text" id="searchQuery" placeholder="æœç´¢ä»»åŠ¡æ ‡é¢˜æˆ–æè¿°..." oninput="applyFilters()">
                    </div>
                </div>
            </div>
            
            <div class="add-task">
                <h3>â• æ·»åŠ æ–°ä»»åŠ¡</h3>
                <div class="form-group">
                    <label>ä»»åŠ¡æ ‡é¢˜</label>
                    <input type="text" id="taskTitle" placeholder="è¾“å…¥ä»»åŠ¡æ ‡é¢˜...">
                </div>
                <div class="form-group">
                    <label>ä»»åŠ¡æè¿°</label>
                    <textarea id="taskDescription" placeholder="è¾“å…¥ä»»åŠ¡æè¿°..."></textarea>
                </div>
                <div class="form-group">
                    <label>ä¼˜å…ˆçº§</label>
                    <select id="taskPriority">
                        <option value="high">ğŸ”´ é«˜ä¼˜å…ˆçº§</option>
                        <option value="medium" selected>ğŸŸ¡ ä¸­ä¼˜å…ˆçº§</option>
                        <option value="low">ğŸŸ¢ ä½ä¼˜å…ˆçº§</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Assignee</label>
                    <select id="taskAssignee">
                        <option value="AI">ğŸ‘¤ AI</option>
                        <option value="User" selected>ğŸ‘¤ User</option>
                    </select>
                </div>
                <button class="btn" onclick="addTask()">æ·»åŠ ä»»åŠ¡</button>
            </div>
            
            <div id="taskList">
                <div class="empty-state">
                    <div class="empty-state-icon">ğŸ“‹</div>
                    <h3>æš‚æ— ä»»åŠ¡</h3>
                    <p>ç‚¹å‡»"åŠ è½½ç¤ºä¾‹ä»»åŠ¡"å¼€å§‹æµ‹è¯•ï¼</p>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let tasks = [];
        let currentTab = 'all';
        
        // ç¤ºä¾‹ä»»åŠ¡æ•°æ®ï¼ˆå¢å¼ºç‰ˆï¼ŒåŒ…å«æ›´å¤šå­—æ®µç”¨äºå¼€å‘éªŒè¯ï¼‰
        const sampleTasks = [
            {
                id: 1,
                title: 'è¯„ä¼° trae-agent çš„èƒ½åŠ›',
                description: 'å¯¹æ¯” OpenClaw + æ–¹èˆŸä»£ç æ¨¡å‹ï¼Œè¯„ä¼°å®ƒæ”¹ç¬”è®°ä»£ç çš„æ•ˆæœ',
                priority: 'high',
                status: 'completed',
                assignee: 'AI',
                createdAt: '2026-02-17',
                links: ['trae-agent/', 'Notes/snippets/code-reading-trae-agent.md'],
                definitionOfDone: [
                    'è·‘é€š trae-agent client',
                    'è®¾è®¡ä¸€äº›éœ€æ±‚è®© trae-agent æ¥æ”¹ç¬”è®°ä»£ç ',
                    'è¯„ä¼°å®ƒæ”¹çš„æ•ˆæœå¦‚ä½•',
                    'å¯¹æ¯” OpenClaw + æ–¹èˆŸä»£ç æ¨¡å‹çš„æ•ˆæœ'
                ]
            },
            {
                id: 2,
                title: 'è®¾è®¡å¹¶å®ç° trae-agent OpenClaw Skill',
                description: 'æ•´åˆ trae-agent åˆ° CS-Notes é¡¹ç›®',
                priority: 'high',
                status: 'completed',
                assignee: 'AI',
                createdAt: '2026-02-17',
                links: ['.trae/documents/trae-agent-è¯„ä¼°æŠ¥å‘Š.md', 'trae-agent/'],
                definitionOfDone: [
                    'åˆ›å»º trae-agent OpenClaw Skill',
                    'Skill å¯ä»¥è°ƒç”¨ trae-agent æ‰§è¡Œå¤æ‚ä»»åŠ¡',
                    'Skill å¯ä»¥è·å– trae-agent çš„è½¨è¿¹è®°å½•å’Œæ‰§è¡Œç»“æœ',
                    'ç»¼åˆ OpenClaw å’Œ trae-agent çš„èƒ½åŠ›ï¼Œä¸€åŠ ä¸€å¤§äºäºŒ'
                ]
            },
            {
                id: 3,
                title: 'è½åœ° Todos Web Manager',
                description: 'æä¾›æ‰‹æœºå¯ç”¨çš„æäº¤å…¥å£ï¼Œæä¾›ä»»åŠ¡åˆ—è¡¨é¡µ',
                priority: 'high',
                status: 'in-progress',
                assignee: 'AI',
                createdAt: '2026-02-17',
                links: ['.trae/documents/INBOX.md', '.trae/documents/Todos-Web-Manager-è®¾è®¡æ–¹æ¡ˆ.md'],
                definitionOfDone: [
                    'æä¾›ä¸€ä¸ªæ‰‹æœºå¯ç”¨çš„æäº¤å…¥å£ï¼ŒæŠŠä»»åŠ¡å†™å…¥ .trae/documents/INBOX.md æˆ– Pending',
                    'æä¾›ä¸€ä¸ªåˆ—è¡¨é¡µå¯æŸ¥çœ‹ Pending/è¿›è¡Œä¸­/å·²å®Œæˆï¼Œå¹¶æ”¯æŒæ ‡è®°å®Œæˆä¸ç­›é€‰',
                    'æ¯ä¸ªä»»åŠ¡æ”¯æŒ Plan ä¸æ‰§è¡Œäº§ç‰©å›å†™ï¼ˆæ‘˜è¦/é“¾æ¥/diff/å¤ç°å‘½ä»¤ï¼‰'
                ]
            },
            {
                id: 4,
                title: 'å®ç° Todos Web Manager Phase 2',
                description: 'å®ç°ä»»åŠ¡åˆ†ç±»å’Œç­›é€‰ã€æœç´¢åŠŸèƒ½',
                priority: 'high',
                status: 'in-progress',
                assignee: 'AI',
                createdAt: '2026-02-18',
                links: ['.trae/web-manager/index.html', '.trae/documents/Todos-Web-Manager-æ ¸å¿ƒåŠŸèƒ½å®ç°æ–¹æ¡ˆ.md'],
                definitionOfDone: [
                    'å®ç°ä»»åŠ¡åˆ†ç±»å’Œç­›é€‰',
                    'å®ç°æœç´¢åŠŸèƒ½',
                    'å®ç° Git é›†æˆ',
                    'éƒ¨ç½²åˆ°ç«å±±å¼•æ“'
                ]
            },
            {
                id: 5,
                title: 'è°ƒç ” Top Lean AI æ¦œå•ä¸Šæ‰€æœ‰å…¬å¸',
                description: 'åˆ†ç±»è®°å½•æ•´ç†åˆ° AI Agent ç¬”è®°ä¸­',
                priority: 'high',
                status: 'pending',
                assignee: 'AI',
                createdAt: '2026-02-18',
                links: ['.trae/documents/Top-Lean-AI-æ¦œå•-2026-02.md', 'Notes/AI-Agent-Product&PE.md'],
                definitionOfDone: [
                    'è°ƒç ” Top Lean AI æ¦œå•ä¸Šæ‰€æœ‰ 45 å®¶å…¬å¸',
                    'åˆ†ç±»è®°å½•æ•´ç†åˆ° AI Agent ç¬”è®°ä¸­',
                    'åŒ…å«å…¬å¸ä¿¡æ¯ã€ç±»å‹ã€äººå‡å¹´æ”¶å…¥ã€å•†ä¸šæ¨¡å¼ç­‰'
                ]
            },
            {
                id: 6,
                title: 'å†™ä¸€ç¯‡å…³äº AI Agent çš„æ–‡ç« ',
                description: 'æ•´ç†ä¸€ä¸‹æœ€è¿‘å¯¹ AI Agent çš„æ€è€ƒ',
                priority: 'medium',
                status: 'pending',
                assignee: 'User',
                createdAt: '2026-02-18',
                links: [],
                definitionOfDone: []
            },
            {
                id: 7,
                title: 'æ•´ç†ä¸€ä¸‹å­¦ä¹ ç¬”è®°',
                description: 'æŠŠä»Šå¤©å­¦çš„å†…å®¹æ•´ç†åˆ°ç¬”è®°åº“ä¸­',
                priority: 'low',
                status: 'pending',
                assignee: 'User',
                createdAt: '2026-02-18',
                links: [],
                definitionOfDone: []
            }
        ];
        
        // å¼€å‘éªŒè¯æ—¥å¿—
        function logDev(message, type = 'info') {
            const devStatus = document.getElementById('devStatus');
            const timestamp = new Date().toLocaleTimeString();
            const line = document.createElement('div');
            line.className = `dev-status-line ${type}`;
            line.textContent = `[${timestamp}] ${message}`;
            devStatus.appendChild(line);
            devStatus.scrollTop = devStatus.scrollHeight;
        }
        
        // åŠ è½½ç¤ºä¾‹ä»»åŠ¡
        function loadSampleTasks() {
            logDev('å¼€å§‹åŠ è½½ç¤ºä¾‹ä»»åŠ¡...', 'info');
            tasks = [...sampleTasks];
            logDev(`âœ… æˆåŠŸåŠ è½½ ${tasks.length} ä¸ªç¤ºä¾‹ä»»åŠ¡`, 'success');
            renderTasks();
        }
        
        // åŠ è½½ JSON æ–‡ä»¶
        function loadJSONFile(event) {
            const file = event.target.files[0];
            if (!file) {
                return;
            }
            
            logDev(`å¼€å§‹åŠ è½½ JSON æ–‡ä»¶: ${file.name}...`, 'info');
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    logDev('âœ… JSON æ–‡ä»¶è§£ææˆåŠŸ', 'success');
                    
                    // å°è¯•ä»ä¸åŒçš„å­—æ®µååŠ è½½ä»»åŠ¡
                    if (data.todos && Array.isArray(data.todos)) {
                        tasks = data.todos.map(convertTodoFormat);
                        logDev(`âœ… ä» 'todos' å­—æ®µåŠ è½½ ${tasks.length} ä¸ªä»»åŠ¡`, 'success');
                    } else if (data.tasks && Array.isArray(data.tasks)) {
                        tasks = data.tasks.map(convertTodoFormat);
                        logDev(`âœ… ä» 'tasks' å­—æ®µåŠ è½½ ${tasks.length} ä¸ªä»»åŠ¡`, 'success');
                    } else {
                        logDev('âŒ æœªæ‰¾åˆ°ä»»åŠ¡æ•°æ®ï¼Œè¯·æ£€æŸ¥ JSON æ–‡ä»¶æ ¼å¼', 'error');
                        return;
                    }
                    
                    renderTasks();
                } catch (error) {
                    logDev(`âŒ JSON è§£æå¤±è´¥: ${error.message}`, 'error');
                }
            };
            reader.readAsText(file);
        }
        
        // è½¬æ¢ todo æ ¼å¼ï¼ˆå…¼å®¹ä¸åŒçš„ JSON æ ¼å¼ï¼‰
        function convertTodoFormat(todo) {
            return {
                id: todo.id || todo.task_id || `task-${Date.now()}`,
                title: todo.title || todo.task_title || 'æœªå‘½åä»»åŠ¡',
                description: todo.description || todo.progress || '',
                status: todo.status || (todo.completed ? 'completed' : 'pending'),
                priority: (todo.priority || 'medium').toLowerCase(),
                assignee: todo.assignee || todo.assignee_name || 'User',
                links: todo.links || [],
                definitionOfDone: todo.definition_of_done || todo.definitionOfDone || [],
                progress: todo.progress || '',
                startedAt: todo.started_at || todo.startedAt || '',
                completedAt: todo.completed_at || todo.completedAt || '',
                createdAt: todo.created_at || todo.createdAt || new Date().toISOString().split('T')[0]
            };
        }
        
        // æµ‹è¯• Markdown è§£æ
        function parseMarkdownTest() {
            logDev('å¼€å§‹æµ‹è¯• Markdown è§£æ...', 'info');
            
            // æ¨¡æ‹Ÿ Markdown è§£æ
            const testMarkdown = `* [ ] æµ‹è¯•ä»»åŠ¡ 1
  - Priorityï¼šHigh
  - Assigneeï¼šAI
  - Feedback Requiredï¼šå¦
* [x] æµ‹è¯•ä»»åŠ¡ 2
  - Priorityï¼šMedium
  - Assigneeï¼šUser
  - Completed Atï¼š2026-02-19`;
            
            logDev('æµ‹è¯• Markdown å†…å®¹:', 'info');
            logDev(testMarkdown, 'info');
            
            // ç®€å•è§£ææµ‹è¯•
            const parsedTasks = [];
            const lines = testMarkdown.split('\n');
            let currentTask = null;
            
            for (let line of lines) {
                if (line.startsWith('* [') || line.startsWith('- [')) {
                    if (currentTask) {
                        parsedTasks.push(currentTask);
                    }
                    const isCompleted = line.includes('[x]');
                    const title = line.replace(/^(\*|-)\s+\[[ x]\]\s*/, '');
                    currentTask = {
                        id: parsedTasks.length + 1,
                        title,
                        status: isCompleted ? 'completed' : 'pending',
                        priority: 'medium',
                        assignee: 'User',
                        createdAt: new Date().toISOString().split('T')[0]
                    };
                } else if (line.includes('Priorityï¼š')) {
                    const priority = line.match(/Priorityï¼š(high|medium|low)/i);
                    if (priority && currentTask) {
                        currentTask.priority = priority[1].toLowerCase();
                    }
                } else if (line.includes('Assigneeï¼š')) {
                    const assignee = line.match(/Assigneeï¼š(\w+)/i);
                    if (assignee && currentTask) {
                        currentTask.assignee = assignee[1];
                    }
                }
            }
            
            if (currentTask) {
                parsedTasks.push(currentTask);
            }
            
            logDev(`âœ… æˆåŠŸè§£æ ${parsedTasks.length} ä¸ªä»»åŠ¡`, 'success');
            parsedTasks.forEach(task => {
                logDev(`  - ${task.title} (${task.priority}, ${task.assignee})`, 'info');
            });
        }
        
        // æµ‹è¯• Markdown ç”Ÿæˆ
        function generateMarkdownTest() {
            logDev('å¼€å§‹æµ‹è¯• Markdown ç”Ÿæˆ...', 'info');
            
            const testTask = {
                title: 'æµ‹è¯•ç”Ÿæˆ Markdown',
                description: 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ä»»åŠ¡',
                priority: 'high',
                status: 'pending',
                assignee: 'AI',
                createdAt: '2026-02-19'
            };
            
            let markdown = '';
            
            // ç”Ÿæˆä»»åŠ¡ Markdown
            const statusBox = testTask.status === 'completed' ? '[x]' : '[ ]';
            markdown += `* ${statusBox} ${testTask.title}\n`;
            markdown += `  - Priorityï¼š${testTask.priority.charAt(0).toUpperCase() + testTask.priority.slice(1)}\n`;
            markdown += `  - Assigneeï¼š${testTask.assignee}\n`;
            markdown += `  - Feedback Requiredï¼šå¦\n`;
            markdown += `  - Definition of Doneï¼š\n`;
            markdown += `    * æµ‹è¯• Markdown ç”ŸæˆåŠŸèƒ½\n`;
            markdown += `    * éªŒè¯æ ¼å¼æ­£ç¡®\n`;
            markdown += `  - Progressï¼š\n`;
            markdown += `  - Started Atï¼š${testTask.createdAt}\n`;
            
            logDev('ç”Ÿæˆçš„ Markdown:', 'info');
            logDev(markdown, 'info');
            logDev('âœ… Markdown ç”Ÿæˆæµ‹è¯•å®Œæˆ', 'success');
        }
        
        // æµ‹è¯• Git é›†æˆ
        function testGitIntegration() {
            logDev('å¼€å§‹æµ‹è¯• Git é›†æˆ...', 'info');
            logDev('ğŸ“‹ Git é›†æˆåŠŸèƒ½åˆ—è¡¨:', 'info');
            logDev('  - git status: æ£€æŸ¥ git çŠ¶æ€', 'info');
            logDev('  - git add: æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒº', 'info');
            logDev('  - git commit: æäº¤æ›´æ”¹', 'info');
            logDev('  - git push: æ¨é€åˆ°è¿œç¨‹ä»“åº“', 'info');
            logDev('  - git pull: ä»è¿œç¨‹ä»“åº“æ‹‰å–', 'info');
            logDev('âš ï¸ æ³¨æ„ï¼šæµè§ˆå™¨ç«¯æ— æ³•ç›´æ¥æ‰§è¡Œ Git å‘½ä»¤', 'info');
            logDev('ğŸ’¡ å»ºè®®ï¼šä½¿ç”¨åç«¯æœåŠ¡ï¼ˆNode.js/Pythonï¼‰æ¥æ‰§è¡Œ Git å‘½ä»¤', 'info');
            logDev('âœ… Git é›†æˆæµ‹è¯•å®Œæˆ', 'success');
        }
        
        // å¯¼å‡ºä»»åŠ¡ JSON
        function exportTasksJSON() {
            logDev('å¼€å§‹å¯¼å‡ºä»»åŠ¡ JSON...', 'info');
            
            const exportData = {
                exportTime: new Date().toISOString(),
                version: '1.0.0-enhanced',
                tasks: tasks,
                stats: {
                    total: tasks.length,
                    pending: tasks.filter(t => t.status === 'pending').length,
                    inProgress: tasks.filter(t => t.status === 'in-progress').length,
                    completed: tasks.filter(t => t.status === 'completed').length
                }
            };
            
            const jsonStr = JSON.stringify(exportData, null, 2);
            logDev('å¯¼å‡ºçš„ JSON æ•°æ®:', 'info');
            logDev(jsonStr.substring(0, 500) + (jsonStr.length > 500 ? '...' : ''), 'info');
            
            // ä¸‹è½½ JSON æ–‡ä»¶
            const blob = new Blob([jsonStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `todos-export-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            logDev('âœ… ä»»åŠ¡ JSON å¯¼å‡ºæˆåŠŸ', 'success');
        }
        
        // éªŒè¯ä»»åŠ¡æ•°æ®
        function validateTasks() {
            logDev('å¼€å§‹éªŒè¯ä»»åŠ¡æ•°æ®...', 'info');
            
            let errors = 0;
            let warnings = 0;
            
            tasks.forEach((task, index) => {
                // éªŒè¯å¿…éœ€å­—æ®µ
                if (!task.title) {
                    logDev(`âŒ ä»»åŠ¡ ${index + 1}: ç¼ºå°‘ title å­—æ®µ`, 'error');
                    errors++;
                }
                if (!task.priority) {
                    logDev(`âš ï¸ ä»»åŠ¡ ${index + 1}: ç¼ºå°‘ priority å­—æ®µ`, 'error');
                    warnings++;
                }
                if (!task.status) {
                    logDev(`âš ï¸ ä»»åŠ¡ ${index + 1}: ç¼ºå°‘ status å­—æ®µ`, 'error');
                    warnings++;
                }
                if (!task.assignee) {
                    logDev(`âš ï¸ ä»»åŠ¡ ${index + 1}: ç¼ºå°‘ assignee å­—æ®µ`, 'error');
                    warnings++;
                }
                
                // éªŒè¯å­—æ®µå€¼
                if (task.priority && !['high', 'medium', 'low'].includes(task.priority)) {
                    logDev(`âŒ ä»»åŠ¡ ${index + 1}: æ— æ•ˆçš„ priority å€¼: ${task.priority}`, 'error');
                    errors++;
                }
                if (task.status && !['pending', 'in-progress', 'completed'].includes(task.status)) {
                    logDev(`âŒ ä»»åŠ¡ ${index + 1}: æ— æ•ˆçš„ status å€¼: ${task.status}`, 'error');
                    errors++;
                }
            });
            
            logDev(`âœ… éªŒè¯å®Œæˆ: ${tasks.length} ä¸ªä»»åŠ¡`, 'success');
            logDev(`   - é”™è¯¯: ${errors} ä¸ª`, errors > 0 ? 'error' : 'success');
            logDev(`   - è­¦å‘Š: ${warnings} ä¸ª`, warnings > 0 ? 'error' : 'success');
            
            if (errors === 0 && warnings === 0) {
                logDev('ğŸ‰ æ‰€æœ‰ä»»åŠ¡æ•°æ®éªŒè¯é€šè¿‡ï¼', 'success');
            }
        }
        
        // æ¸…ç©ºå¼€å‘æ—¥å¿—
        function clearDevStatus() {
            document.getElementById('devStatus').innerHTML = '<div class="dev-status-line info">ğŸ‘‰ æ—¥å¿—å·²æ¸…ç©º</div>';
        }
        
        // åˆå§‹åŒ–
        async function init() {
            logDev('ğŸ‰ Todos Web Manager å¢å¼ºç‰ˆï¼ˆå¼€å‘éªŒè¯ï¼‰å·²å¯åŠ¨', 'success');
            logDev('ğŸ“‹ å¯ç”¨çš„å¼€å‘éªŒè¯åŠŸèƒ½:', 'info');
            logDev('   - åŠ è½½ç¤ºä¾‹ä»»åŠ¡', 'info');
            logDev('   - æµ‹è¯• Markdown è§£æ', 'info');
            logDev('   - æµ‹è¯• Markdown ç”Ÿæˆ', 'info');
            logDev('   - æµ‹è¯• Git é›†æˆ', 'info');
            logDev('   - å¯¼å‡ºä»»åŠ¡ JSON', 'info');
            logDev('   - éªŒè¯ä»»åŠ¡æ•°æ®', 'info');
            
            // è‡ªåŠ¨åŠ è½½ä»“åº“é‡Œçš„ todos.json
            await loadTodosFromRepo();
        }
        
        // ä»ä»“åº“åŠ è½½ todos.json
        async function loadTodosFromRepo() {
            logDev('ğŸ“‚ å°è¯•ä»ä»“åº“åŠ è½½ todos.json...', 'info');
            
            try {
                // å°è¯•ä»ä¸åŒçš„è·¯å¾„åŠ è½½
                const paths = [
                    '../../.trae/todos/todos.json',
                    '../.trae/todos/todos.json',
                    '.trae/todos/todos.json',
                    'todos.json'
                ];
                
                let loaded = false;
                for (const path of paths) {
                    try {
                        logDev(`ğŸ” å°è¯•åŠ è½½: ${path}`, 'info');
                        const response = await fetch(path);
                        if (response.ok) {
                            const data = await response.json();
                            
                            // å°è¯•ä»ä¸åŒçš„å­—æ®µååŠ è½½ä»»åŠ¡
                            if (data.todos && Array.isArray(data.todos)) {
                                tasks = data.todos.map(convertTodoFormat);
                                logDev(`âœ… æˆåŠŸä» 'todos' å­—æ®µåŠ è½½ ${tasks.length} ä¸ªä»»åŠ¡`, 'success');
                            } else if (data.tasks && Array.isArray(data.tasks)) {
                                tasks = data.tasks.map(convertTodoFormat);
                                logDev(`âœ… æˆåŠŸä» 'tasks' å­—æ®µåŠ è½½ ${tasks.length} ä¸ªä»»åŠ¡`, 'success');
                            } else {
                                logDev('âŒ æœªæ‰¾åˆ°ä»»åŠ¡æ•°æ®ï¼Œè¯·æ£€æŸ¥ JSON æ–‡ä»¶æ ¼å¼', 'error');
                                return;
                            }
                            
                            renderTasks();
                            loaded = true;
                            break;
                        }
                    } catch (error) {
                        logDev(`âš ï¸ åŠ è½½å¤±è´¥: ${path} - ${error.message}`, 'warning');
                        continue;
                    }
                }
                
                if (!loaded) {
                    logDev('âš ï¸ æ— æ³•è‡ªåŠ¨åŠ è½½ todos.jsonï¼Œè¯·ä½¿ç”¨"ğŸ“‚ åŠ è½½ JSON æ–‡ä»¶"æŒ‰é’®æ‰‹åŠ¨åŠ è½½', 'warning');
                }
                
            } catch (error) {
                logDev(`âŒ è‡ªåŠ¨åŠ è½½å¤±è´¥: ${error.message}`, 'error');
                logDev('ğŸ’¡ è¯·ä½¿ç”¨"ğŸ“‚ åŠ è½½ JSON æ–‡ä»¶"æŒ‰é’®æ‰‹åŠ¨åŠ è½½', 'info');
            }
        }
        
        // æ ‡ç­¾é¡µåˆ‡æ¢
        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[data-tab="${tab}"]`).classList.add('active');
            
            // å¼€å‘éªŒè¯æ ‡ç­¾é¡µç‰¹æ®Šå¤„ç†
            const devPanel = document.getElementById('devPanel');
            if (tab === 'dev') {
                devPanel.style.display = 'block';
            } else {
                devPanel.style.display = 'block'; // å§‹ç»ˆæ˜¾ç¤ºå¼€å‘é¢æ¿
            }
            
            renderTasks();
        }
        
        // åº”ç”¨ç­›é€‰
        function applyFilters() {
            renderTasks();
        }
        
        // è·å–ç­›é€‰åçš„ä»»åŠ¡
        function getFilteredTasks() {
            let filtered = [...tasks];
            
            // 1. æŒ‰çŠ¶æ€ç­›é€‰ï¼ˆæ ‡ç­¾é¡µï¼‰
            if (currentTab !== 'all' && currentTab !== 'dev') {
                filtered = filtered.filter(task => task.status === currentTab);
            } else if (currentTab === 'dev') {
                // å¼€å‘éªŒè¯æ ‡ç­¾é¡µæ˜¾ç¤ºæ‰€æœ‰ä»»åŠ¡
                filtered = [...tasks];
            }
            
            // 2. æŒ‰ä¼˜å…ˆçº§ç­›é€‰
            const filterPriority = document.getElementById('filterPriority').value;
            if (filterPriority !== 'all') {
                filtered = filtered.filter(task => task.priority === filterPriority);
            }
            
            // 3. æŒ‰ Assignee ç­›é€‰
            const filterAssignee = document.getElementById('filterAssignee').value;
            if (filterAssignee !== 'all') {
                filtered = filtered.filter(task => task.assignee === filterAssignee);
            }
            
            // 4. æŒ‰æœç´¢å…³é”®è¯ç­›é€‰
            const searchQuery = document.getElementById('searchQuery').value.toLowerCase().trim();
            if (searchQuery) {
                filtered = filtered.filter(task => 
                    task.title.toLowerCase().includes(searchQuery) || 
                    task.description.toLowerCase().includes(searchQuery)
                );
            }
            
            return filtered;
        }
        
        // æ¸²æŸ“ä»»åŠ¡åˆ—è¡¨
        function renderTasks() {
            const filteredTasks = getFilteredTasks();
            const taskList = document.getElementById('taskList');
            
            if (filteredTasks.length === 0) {
                taskList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“‹</div>
                        <h3>æš‚æ— åŒ¹é…ä»»åŠ¡</h3>
                        <p>å°è¯•è°ƒæ•´ç­›é€‰æ¡ä»¶æˆ–æœç´¢å…³é”®è¯ï¼</p>
                    </div>
                `;
                return;
            }
            
            taskList.innerHTML = `
                <ul class="task-list">
                    ${filteredTasks.map(task => `
                        <li class="task-item">
                            <div class="task-header">
                                <div class="task-title">${task.title}</div>
                                <span class="task-priority priority-${task.priority}">
                                    ${task.priority === 'high' ? 'ğŸ”´ é«˜' : task.priority === 'medium' ? 'ğŸŸ¡ ä¸­' : 'ğŸŸ¢ ä½'}
                                </span>
                            </div>
                            <div class="task-description">${task.description}</div>
                            <div class="task-meta">
                                <span>ğŸ‘¤ ${task.assignee}</span>
                                <span>